---
import LessonLayout from '../../layouts/LessonLayout.astro';
import HintBox from '../../components/astro/HintBox.astro';

// 퀴즈 옵션
const quiz1Options = JSON.stringify(["if-then-end", "if-do-end", "when-then-end", "if-else"]);
const quiz2Options = JSON.stringify(["==", "=", "===", ":="]);

// 에디터 코드
const editorCode1 = `-- 조건문 기본
local score = 85

if score >= 90 then
    print("A등급!")
elseif score >= 80 then
    print("B등급!")
else
    print("다시 도전!")
end`;

const editorCode2 = `-- 플레이어 체크 예시
local part = script.Parent

local function onTouched(otherPart)
    local humanoid = otherPart.Parent:FindFirstChild("Humanoid")

    if humanoid then
        print("플레이어가 닿았어요!")
        humanoid.Health = 0  -- Kill Part!
    else
        print("플레이어가 아닌 것이 닿았어요")
    end
end

part.Touched:Connect(onTouched)
print("Kill Part 준비 완료!")`;
---

<LessonLayout title="조건문" lessonNumber={4} totalSlides={6}>
    <!-- 슬라이드 1: 인트로 -->
    <section class="slide active">
        <div class="max-w-4xl mx-auto px-6 py-12 flex flex-col items-center justify-center min-h-[80vh]">
            <div class="text-center animate-in">
                <span class="badge badge-roblox mb-6">4차시</span>
                <h1 class="title-display mb-4">
                    <span class="text-neon-gold">조건문</span>
                </h1>
                <p class="text-xl text-ink-light max-w-lg mx-auto mb-8">
                    "만약 ~라면" 상황에 따라<br>
                    다른 코드를 실행하는 방법을 배워요
                </p>
                <div class="flex gap-4 justify-center flex-wrap">
                    <div class="px-4 py-2 bg-ink-pale rounded-full text-sm">
                        <span class="font-bold">🔀 if-then-end</span>
                    </div>
                    <div class="px-4 py-2 bg-ink-pale rounded-full text-sm">
                        <span class="font-bold">⚖️ 비교 연산자</span>
                    </div>
                    <div class="px-4 py-2 bg-ink-pale rounded-full text-sm">
                        <span class="font-bold">💀 Kill Part</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 슬라이드 2: 조건문이란? -->
    <section class="slide">
        <div class="max-w-4xl mx-auto px-6 py-12">
            <div class="animate-in">
                <span class="badge badge-lesson mb-4">개념 학습</span>
                <h2 class="title-section mb-6">조건문이란?</h2>
            </div>

            <div class="flex flex-col gap-8">
                <div class="animate-in">
                    <div class="lesson-card">
                        <h3 class="font-bold text-lg mb-4 flex items-center gap-2">
                            <span class="text-2xl">🔀</span>
                            갈림길에서 선택하기
                        </h3>
                        <p class="text-ink-light mb-4">
                            조건문은 <strong>"만약 ~라면"</strong> 상황에 따라
                            다른 코드를 실행하게 해요.
                        </p>
                        <div class="bg-gradient-to-r from-amber-50 to-yellow-50 rounded-xl p-4">
                            <div class="text-sm mb-2">예를 들면...</div>
                            <ul class="text-sm space-y-1">
                                <li>🎮 점수가 100점이면 → "만점!" 출력</li>
                                <li>❤️ 체력이 0이면 → 게임 오버</li>
                                <li>👤 플레이어가 닿으면 → 데미지 주기</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="animate-in">
                    <div class="lesson-card">
                        <h3 class="font-bold text-lg mb-4">기본 형태</h3>
                        <lua-code-block>
if 조건 then
    -- 조건이 참이면 실행
end

-- 또는

if 조건 then
    -- 참일 때
else
    -- 거짓일 때
end
                        </lua-code-block>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 슬라이드 3: 비교 연산자 -->
    <section class="slide">
        <div class="max-w-4xl mx-auto px-6 py-12">
            <div class="animate-in">
                <span class="badge badge-lua mb-4">비교 연산자</span>
                <h2 class="title-section mb-6">조건 만들기</h2>
            </div>

            <div class="animate-in mb-6">
                <p class="text-lg text-ink-light">
                    조건을 만들려면 <strong>비교 연산자</strong>를 사용해요!
                </p>
            </div>

            <div class="grid md:grid-cols-3 gap-4 animate-in mb-8">
                <div class="lesson-card text-center">
                    <code class="text-2xl font-bold text-neon-sky">==</code>
                    <p class="text-sm text-ink-light mt-2">같다</p>
                    <code class="text-xs mt-1 block">score == 100</code>
                </div>
                <div class="lesson-card text-center">
                    <code class="text-2xl font-bold text-neon-sky">~=</code>
                    <p class="text-sm text-ink-light mt-2">같지 않다</p>
                    <code class="text-xs mt-1 block">name ~= "Guest"</code>
                </div>
                <div class="lesson-card text-center">
                    <code class="text-2xl font-bold text-neon-sky">&gt;</code>
                    <p class="text-sm text-ink-light mt-2">크다</p>
                    <code class="text-xs mt-1 block">score &gt; 50</code>
                </div>
                <div class="lesson-card text-center">
                    <code class="text-2xl font-bold text-neon-sky">&lt;</code>
                    <p class="text-sm text-ink-light mt-2">작다</p>
                    <code class="text-xs mt-1 block">health &lt; 20</code>
                </div>
                <div class="lesson-card text-center">
                    <code class="text-2xl font-bold text-neon-sky">&gt;=</code>
                    <p class="text-sm text-ink-light mt-2">크거나 같다</p>
                    <code class="text-xs mt-1 block">level &gt;= 10</code>
                </div>
                <div class="lesson-card text-center">
                    <code class="text-2xl font-bold text-neon-sky">&lt;=</code>
                    <p class="text-sm text-ink-light mt-2">작거나 같다</p>
                    <code class="text-xs mt-1 block">coins &lt;= 0</code>
                </div>
            </div>

            <HintBox type="warning" title="주의!">
                <code>=</code>는 값을 넣는 것 (대입), <code>==</code>는 비교하는 것!<br>
                <code>score = 100</code> (점수를 100으로 설정) vs <code>score == 100</code> (점수가 100인가?)
            </HintBox>
        </div>
    </section>

    <!-- 슬라이드 4: 조건문 실습 (전체화면) -->
    <section class="slide slide-fullscreen">
        <lua-editor
            mission="score 값을 바꿔서 다른 등급이 나오게 해보세요 (90↑=A, 80↑=B, 70↑=C, 나머지=F)"
            initial-code={editorCode1}
            hints='["score 변수의 숫자를 바꿔보세요", "90 이상은 A, 80 이상은 B예요"]'
        ></lua-editor>
    </section>

    <!-- 슬라이드 5: Kill Part 만들기 (전체화면) -->
    <section class="slide slide-fullscreen">
        <lua-editor
            mission="💀 Kill Part: 플레이어가 닿으면 체력을 0으로 만들기 (FindFirstChild로 Humanoid 확인)"
            initial-code={editorCode2}
            hints='["Humanoid가 있으면 플레이어예요", "Health = 0으로 즉사시켜요"]'
        ></lua-editor>
    </section>

    <!-- 슬라이드 6: 퀴즈 -->
    <section class="slide">
        <div class="max-w-3xl mx-auto px-6 py-12">
            <div class="animate-in">
                <span class="badge badge-quiz mb-4">확인 퀴즈</span>
                <h2 class="title-section mb-8">1개월차 마무리!</h2>
            </div>

            <div class="space-y-6">
                <div class="animate-in">
                    <quiz-question
                        question="Lua에서 조건문의 기본 형태는?"
                        correct="A"
                        options={quiz1Options}
                        correct-explanation="정답! if 조건 then ... end 형태로 사용해요."
                        wrong-explanation="if-then-end가 정답이에요. else와 elseif를 추가할 수도 있어요."
                    ></quiz-question>
                </div>

                <div class="animate-in">
                    <quiz-question
                        question="두 값이 같은지 비교할 때 사용하는 연산자는?"
                        correct="A"
                        options={quiz2Options}
                        correct-explanation="맞아요! ==는 비교, =는 대입이에요. 헷갈리지 마세요!"
                        wrong-explanation="== (등호 2개)가 정답이에요. =는 값을 넣는 대입 연산자예요."
                    ></quiz-question>
                </div>
            </div>

            <div class="animate-in mt-8">
                <div class="bg-gradient-to-r from-neon-mint/20 via-neon-sky/20 to-neon-gold/20 rounded-2xl p-6 text-center">
                    <div class="text-3xl mb-3">🎉</div>
                    <h3 class="font-bold text-xl mb-2">1개월차 완료!</h3>
                    <p class="text-ink-light mb-4">
                        축하해요! 로블록스 개발의 기초를 모두 배웠어요.
                    </p>
                    <div class="flex flex-wrap justify-center gap-2">
                        <span class="badge badge-success">변수</span>
                        <span class="badge badge-success">함수</span>
                        <span class="badge badge-success">이벤트</span>
                        <span class="badge badge-success">조건문</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Lit 컴포넌트 로드 -->
    <script>
        import('../../components/lit/index').catch(console.error);
    </script>
</LessonLayout>
